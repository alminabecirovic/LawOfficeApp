<Window x:Class="LawOfficeApp.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:LawOfficeApp"
        Title="Upravljanje advokatskom kancelarijom" Height="600" Width="900" Background="White">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- HEADER -->
        <StackPanel Grid.Row="0" Background="White" Margin="20,20,20,10">
            <TextBlock Text="Advokatska kanncelarija" FontSize="22" FontWeight="Bold" Margin="0,0,0,15"/>
            <StackPanel Orientation="Horizontal">
                <Button Content="Kontrolna tabla" Width="120" Height="30" Margin="0,0,10,0" 
                        Command="{Binding ShowDashboardCommand}"/>
                <Button Content="Klijenti" Width="90" Height="30" Margin="0,0,10,0" 
                        Command="{Binding ShowClientsCommand}"/>
                <Button Content="Predmeti" Width="90" Height="30" Margin="0,0,10,0" 
                        Command="{Binding ShowCasesCommand}"/>
                <Button Content="Fakture" Width="90" Height="30" Margin="0,0,10,0" 
                        Command="{Binding ShowInvoicesCommand}"/>
            </StackPanel>
            <Separator Margin="0,15,0,0"/>
        </StackPanel>

        <!-- CONTENT -->
        <ScrollViewer Grid.Row="1" Background="White">
            <StackPanel Margin="20">

                <!-- DASHBOARD -->
                <StackPanel Visibility="{Binding DashboardVisibility}">
                    <TextBlock Text="Kontrolna tabla" FontSize="18" FontWeight="Bold" Margin="0,0,0,15"/>

                    <TextBlock Text="Aktivni predmeti" FontWeight="Bold" Margin="0,10,0,5"/>
                    <DataGrid ItemsSource="{Binding DashboardVM.ActiveCases}" Height="150" AutoGenerateColumns="False" 
                              IsReadOnly="True" BorderBrush="LightGray" BorderThickness="1">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Naziv predmeta" Binding="{Binding CaseTitle}" Width="250"/>
                            <DataGridTextColumn Header="Klijent" Binding="{Binding Client.GetFullName}" Width="150"/>
                            <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="*"/>
                        </DataGrid.Columns>
                    </DataGrid>

                    <TextBlock Text="Nadolazeći rokovi" FontWeight="Bold" Margin="0,20,0,5"/>
                    <DataGrid ItemsSource="{Binding DashboardVM.UpcomingDeadlines}" Height="120" AutoGenerateColumns="False" 
                              IsReadOnly="True" BorderBrush="LightGray" BorderThickness="1">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Predmet" Binding="{Binding CaseTitle}" Width="300"/>
                            <DataGridTextColumn Header="Rok" Binding="{Binding DeadlineDate, StringFormat=d}" Width="*"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </StackPanel>

                <!-- CLIENTS -->
                <StackPanel Visibility="{Binding ClientsVisibility}">
                    <TextBlock Text="Upravljanje klijentima" FontSize="18" FontWeight="Bold" Margin="0,0,0,15"/>

                    <TextBlock Text="Dodaj novog klijenta" FontWeight="Bold" Margin="0,0,0,10"/>
                    <StackPanel>
                        <TextBlock Text="Ime"/>
                        <TextBox Text="{Binding ClientsVM.FirstName, UpdateSourceTrigger=PropertyChanged}" 
                                 Margin="0,5,0,10" Padding="5"/>
                        <TextBlock Text="Prezime"/>
                        <TextBox Text="{Binding ClientsVM.LastName, UpdateSourceTrigger=PropertyChanged}" 
                                 Margin="0,5,0,10" Padding="5"/>
                        <TextBlock Text="Email"/>
                        <TextBox Text="{Binding ClientsVM.Email, UpdateSourceTrigger=PropertyChanged}" 
                                 Margin="0,5,0,10" Padding="5"/>
                        <TextBlock Text="Telefon"/>
                        <TextBox Text="{Binding ClientsVM.Phone, UpdateSourceTrigger=PropertyChanged}" 
                                 Margin="0,5,0,10" Padding="5"/>
                        <Button Content="Dodaj klijenta" Width="120" Height="30" 
                                HorizontalAlignment="Left" Margin="0,5,0,0" 
                                Command="{Binding ClientsVM.AddClientCommand}"/>
                    </StackPanel>

                    <Separator Margin="0,20"/>

                    <TextBlock Text="Ažuriraj klijenta" FontWeight="Bold" Margin="0,20,0,10"/>
                    <StackPanel>
                        <TextBlock Text="Izaberi klijenta"/>
                        <ComboBox ItemsSource="{Binding ClientsVM.UpdateClientList}" 
                                  SelectedItem="{Binding ClientsVM.SelectedUpdateClient}"
                                  Margin="0,5,0,10" Padding="5" 
                                  DisplayMemberPath="FullName" SelectedValuePath="Id"/>
                        <TextBlock Text="Novi Email"/>
                        <TextBox Text="{Binding ClientsVM.UpdateEmail, UpdateSourceTrigger=PropertyChanged}" 
                                 Margin="0,5,0,10" Padding="5"/>
                        <Button Content="Ažuriraj" Width="100" Height="30" 
                                HorizontalAlignment="Left" Margin="0,5,0,0" 
                                Command="{Binding ClientsVM.UpdateClientCommand}"/>
                    </StackPanel>

                    <Separator Margin="0,20"/>

                    <TextBlock Text="Svi klijenti" FontWeight="Bold" Margin="0,20,0,5"/>
                    <DataGrid ItemsSource="{Binding ClientsVM.Clients}" Height="250" AutoGenerateColumns="False" 
                              IsReadOnly="True" BorderBrush="LightGray" BorderThickness="1">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Ime" Binding="{Binding FirstName}" Width="120"/>
                            <DataGridTextColumn Header="Prezime" Binding="{Binding LastName}" Width="120"/>
                            <DataGridTextColumn Header="Email" Binding="{Binding Email}" Width="180"/>
                            <DataGridTextColumn Header="Telefon" Binding="{Binding PhoneNumber}" Width="120"/>
                            <DataGridTextColumn Header="Predmeti" Binding="{Binding Cases.Count}" Width="*"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </StackPanel>

                <!-- CASES -->
                <StackPanel Visibility="{Binding CasesVisibility}">
                    <TextBlock Text="Profil predmeta" FontSize="18" FontWeight="Bold" Margin="0,0,0,15"/>

                    <TextBlock Text="Dodaj novi predmet" FontWeight="Bold" Margin="0,0,0,10"/>
                    <StackPanel>
                        <TextBlock Text="Naziv predmeta"/>
                        <TextBox Text="{Binding CasesVM.CaseTitle, UpdateSourceTrigger=PropertyChanged}" 
                                 Margin="0,5,0,10" Padding="5"/>
                        <TextBlock Text="Opis"/>
                        <TextBox Text="{Binding CasesVM.Description, UpdateSourceTrigger=PropertyChanged}" 
                                 Height="60" TextWrapping="Wrap" Margin="0,5,0,10" Padding="5"/>
                        <TextBlock Text="Izaberi klijenta"/>
                        <ComboBox ItemsSource="{Binding CasesVM.ClientList}" 
                                  SelectedItem="{Binding CasesVM.SelectedClient}"
                                  Margin="0,5,0,10" Padding="5" 
                                  DisplayMemberPath="FullName" SelectedValuePath="Id"/>
                        <TextBlock Text="Izaberi advokata"/>
                        <ComboBox ItemsSource="{Binding CasesVM.LawyerList}" 
                                  SelectedItem="{Binding CasesVM.SelectedLawyer}"
                                  Margin="0,5,0,10" Padding="5" 
                                  DisplayMemberPath="FullName" SelectedValuePath="Id"/>
                        <TextBlock Text="Rok"/>
                        <DatePicker SelectedDate="{Binding CasesVM.Deadline}" Margin="0,5,0,10"/>
                        <Button Content="Dodaj predmet" Width="120" Height="30" 
                                HorizontalAlignment="Left" Margin="0,5,0,0" 
                                Command="{Binding CasesVM.AddCaseCommand}"/>
                    </StackPanel>

                    <Separator Margin="0,20"/>

                    <TextBlock Text="Svi predmeti - Kliknite za detalje" FontWeight="Bold" Margin="0,20,0,5"/>
                    <DataGrid ItemsSource="{Binding CasesVM.Cases}" 
                              SelectedItem="{Binding CasesVM.SelectedCase}"
                              Height="200" AutoGenerateColumns="False" IsReadOnly="True"
                              BorderBrush="LightGray" BorderThickness="1">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="ID" Binding="{Binding Id}" Width="40"/>
                            <DataGridTextColumn Header="Naziv" Binding="{Binding CaseTitle}" Width="200"/>
                            <DataGridTextColumn Header="Klijent" Binding="{Binding Client.GetFullName}" Width="150"/>
                            <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="100"/>
                            <DataGridTextColumn Header="Rok" Binding="{Binding DeadlineDate, StringFormat=d}" Width="*"/>
                        </DataGrid.Columns>
                    </DataGrid>

                    <Separator Margin="0,20"/>

                    <TextBlock Text="Izabrani predmet - Detaljan profil" FontWeight="Bold" FontSize="16" Margin="0,20,0,10"/>
                    <Border BorderBrush="LightGray" BorderThickness="1" Padding="15" Background="WhiteSmoke">
                        <StackPanel>
                            <TextBlock Text="{Binding CasesVM.CaseDetailsInfo}" 
                                       TextWrapping="Wrap" FontSize="13" Margin="0,0,0,15"/>

                            <!-- Dugmad za promenu statusa -->
                            <StackPanel Orientation="Horizontal" Margin="0,10,0,0">
                                <TextBlock Text="Promeni status: " FontWeight="Bold" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                <Button Content="Aktivan" Width="80" Height="30" Margin="0,0,5,0" 
                                        Command="{Binding CasesVM.SetActiveCommand}"/>
                                <Button Content="Suđenje" Width="80" Height="30" Margin="0,0,5,0" 
                                        Command="{Binding CasesVM.SetTrialCommand}"/>
                                <Button Content="Rešen" Width="80" Height="30" Margin="0,0,5,0" 
                                        Command="{Binding CasesVM.SetResolvedCommand}"/>
                                <Button Content="Odbijen" Width="80" Height="30" Margin="0,0,5,0" 
                                        Command="{Binding CasesVM.SetRejectedCommand}"/>
                                <Button Content="Na čekanju" Width="90" Height="30" 
                                        Command="{Binding CasesVM.SetOnHoldCommand}"/>
                            </StackPanel>
                        </StackPanel>
                    </Border>
                </StackPanel>

                <!-- INVOICES -->
                <StackPanel Visibility="{Binding InvoicesVisibility}">
                    <TextBlock Text="Fakturisanje" FontSize="18" FontWeight="Bold" Margin="0,0,0,15"/>

                    <TextBlock Text="Kreiraj fakturu" FontWeight="Bold" Margin="0,0,0,10"/>
                    <StackPanel>
                        <TextBlock Text="Broj fakture"/>
                        <TextBox Text="{Binding InvoicesVM.InvoiceNumber, UpdateSourceTrigger=PropertyChanged}" 
                                 Margin="0,5,0,10" Padding="5"/>
                        <TextBlock Text="Iznos"/>
                        <TextBox Text="{Binding InvoicesVM.Amount, UpdateSourceTrigger=PropertyChanged}" 
                                 Margin="0,5,0,10" Padding="5"/>
                        <TextBlock Text="Izaberi predmet"/>
                        <ComboBox ItemsSource="{Binding InvoicesVM.CaseList}" 
                                  SelectedItem="{Binding InvoicesVM.SelectedCase}"
                                  Margin="0,5,0,10" Padding="5" 
                                  DisplayMemberPath="CaseTitle" SelectedValuePath="Id"/>
                        <Button Content="Kreiraj fakturu" Width="130" Height="30" 
                                HorizontalAlignment="Left" Margin="0,5,0,0" 
                                Command="{Binding InvoicesVM.CreateInvoiceCommand}"/>
                    </StackPanel>

                    <Separator Margin="0,20"/>

                    <TextBlock Text="Sve fakture" FontWeight="Bold" Margin="0,20,0,5"/>
                    <DataGrid ItemsSource="{Binding InvoicesVM.Invoices}" 
                              SelectedItem="{Binding InvoicesVM.SelectedInvoice}"
                              Height="300" AutoGenerateColumns="False" IsReadOnly="True"
                              BorderBrush="LightGray" BorderThickness="1">
                        <DataGrid.Resources>
                            <local:BoolToYesNoConverter x:Key="BoolToYesNoConverter"/>
                        </DataGrid.Resources>
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Broj fakture" Binding="{Binding InvoiceNumber}" Width="120"/>
                            <DataGridTextColumn Header="Iznos" Binding="{Binding Amount, StringFormat=c}" Width="100"/>
                            <DataGridTextColumn Header="Datum" Binding="{Binding IssueDate, StringFormat=d}" Width="120"/>
                            <DataGridTextColumn Header="Plaćeno" Binding="{Binding IsPaid, Converter={StaticResource BoolToYesNoConverter}}" Width="*"/>
                        </DataGrid.Columns>
                    </DataGrid>
                    <StackPanel Orientation="Horizontal" Margin="0,10,0,0">
                        <TextBlock Text="Promeni status plaćanja: " FontWeight="Bold" VerticalAlignment="Center" Margin="0,0,10,0"/>
                        <Button Content="Označi kao plaćeno" Width="150" Height="30" Margin="0,0,10,0" 
                                Command="{Binding InvoicesVM.MarkAsPaidCommand}"/>
                        <Button Content="Označi kao neplaćeno" Width="160" Height="30" 
                                Command="{Binding InvoicesVM.MarkAsUnpaidCommand}"/>
                    </StackPanel>
                </StackPanel>

            </StackPanel>
        </ScrollViewer>
    </Grid>
</Window>